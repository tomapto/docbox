# 系统防火墙白明白

## centOS7 中首先将 firewalld 换成 iptables
关闭firewalld

```
$ systemctl stop firewalld
$ systemctl disable firewalld
$ systemctl status firewalld
```

启用iptables

```
$ yum install -y iptabls-services
$ systemctl enable iptables
```

## 配置iptables

打开文件 iptables
```
$ vi /etc/sysconfig/iptables
```

将代码到文件内

```
# Generated by iptables-save v1.4.21 on Mon Jul 17 18:27:40 2017
*filter
:INPUT ACCEPT [14:1109]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [27:6195]

-N whitelist
-A whitelist -s 127.0.0.1 -j ACCEPT
-A whitelist -s 123.56.176.7 -j ACCEPT
-A whitelist -s 10.46.165.227 -j ACCEPT

-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j whitelist
-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 443 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 3500 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 3005 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 27017 -j whitelist
-A INPUT -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -j REJECT --reject-with icmp-host-prohibited
COMMIT
# Completed on Mon Jul 17 18:27:40 2017
```

保存完成 

```
$ service iptables restart
```

配置完成